# 📱 健康AI助手开发规范

## 📋 目录
- [项目定位](#项目定位)
- [UI标准化](#UI标准化)
- [权限管理](#权限管理)
- [数据标准化](#数据标准化)
- [AI接口调用](#AI接口调用)
- [调试与测试](#调试与测试)
- [编码规范](#编码规范)
- [无障碍设计](#无障碍设计)
- [本地化](#本地化)
- [安全与隐私](#安全与隐私)
- [性能优化](#性能优化)
- [版本控制](#版本控制)
- [发布流程](#发布流程)

## 📌 项目定位
- 基于iOS平台的AI健康助手应用
- 获取用户设备的健康与运动数据
- 提供基于AI的健康数据分析与个性化健康建议
- 支持用户进行健康相关问题的AI交互咨询

## 🎨 UI标准化
### 界面风格统一性
- 采用Apple官方SF Symbols作为默认图标库
- 支持浅色/深色模式自动适配
- 使用统一的颜色系统：
  - 品牌主色：`#4BC3A4`（薄荷绿）
  - 强调色：`#3A7BFF`（蓝色）
  - 警告色：`#FF9500`（橙色）
  - 错误色：`#FF3B30`（红色）
  - 背景色：系统默认
  - 文本色：系统默认

### 组件标准化
- 使用SwiftUI作为UI框架
- 字体规范：
  - 标题：SF Pro Display, 粗体, 大小20-24pt
  - 副标题：SF Pro Text, 半粗体, 大小18pt
  - 正文：SF Pro Text, 常规, 大小16pt
  - 说明文本：SF Pro Text, 常规, 大小14pt
- 所有组件（按钮、输入框等）统一创建于`Components`目录下

### 导航与布局
- 主导航结构使用`NavigationStack`
- 标签页使用`TabView`
- 间距与边距保持一致：16pt作为基础间距
- 屏幕适配支持所有iPhone尺寸和方向
- 卡片视图圆角统一为12pt

### 状态管理
- 使用`@ObservableObject`和`@Published`进行状态管理
- 复杂状态考虑使用Redux或TCA架构
- 加载状态显示统一的加载指示器

## 🔐 权限管理
### 必需权限
- HealthKit
  - `Privacy - Health Share Usage Description`: "用于分析您的健康数据并提供个性化的健康建议"
  - `Privacy - Health Update Usage Description`: "允许App记录和更新您的健康数据以提供实时反馈和健康建议"

### 可选权限
- 位置权限
  - `Privacy - Location When In Use Usage Description`: "用于记录和分析运动路径和位置数据，帮助优化您的健康建议"
- 通知权限
  - `Privacy - User Notifications Usage Description`: "用于提供实时健康分析提醒和重要健康建议"

### 权限管理流程
- 应用首次启动时逐步引导用户授权
- 提供视觉化说明权限用途
- 实现权限状态检查与重新申请机制
- 在设置页面提供权限管理入口

## 💾 数据标准化
- 健康数据使用HealthKit标准API获取
- 所有数据传输采用JSON格式
- API响应标准格式：
```swift
struct APIResponse<T: Codable> {
    let status: String
    let data: T?
    let error: APIError?
}
```
- 实现本地数据缓存，支持离线使用
- 数据同步机制确保多设备数据一致性

## 🤖 AI接口调用
- 所有API请求使用异步模式（async/await）
- 实现统一的错误处理机制
- API密钥存储于安全环境变量
- 实现请求重试与超时处理
- 用户查询历史记录本地加密存储
- 支持AI模型切换（如OpenAI、Anthropic等）

## 🔍 调试与测试
- 启用Xcode预览支持实时UI调整
- 单元测试覆盖核心业务逻辑（目标覆盖率>80%）
- UI测试确保主要功能流程可用
- 使用模拟数据支持离线开发测试
- 实现应用内日志系统便于问题排查
- 集成崩溃报告工具（如Crashlytics）

## 📝 编码规范
- 采用Apple官方Swift编码规范
- 使用明确的命名约定：
  - 类型名称使用UpperCamelCase
  - 变量和函数名使用lowerCamelCase
  - 常量使用小写字母加下划线（例如：`max_retry_count`）
- 代码分层遵循MVVM架构
- 必要代码必须添加文档注释
- 复杂逻辑应添加详细注释说明
- 定期进行代码审查和重构

## ♿ 无障碍设计
- 支持VoiceOver屏幕阅读
- 提供动态字体大小调整
- 确保所有UI元素有足够的触控区域（至少44×44pt）
- 颜色对比度符合WCAG 2.1 AA标准
- 支持减弱动画效果设置
- 添加适当的无障碍标签和提示

## 🌐 本地化
- 支持中文和英文（后续可扩展）
- 使用标准Localization机制
- 所有字符串使用.strings文件管理
- 日期、时间、数字格式遵循本地化规则
- 图片和图标考虑文化适应性
- 支持RTL（从右至左）语言布局

## 🔒 安全与隐私
- 敏感数据使用Keychain存储
- 网络传输使用HTTPS加SSL加密
- 实现应用内锁屏功能（支持Face ID/Touch ID）
- 用户可选择删除所有本地数据
- 定期安全审计与渗透测试
- 遵循GDPR、CCPA等隐私法规要求

## ⚡ 性能优化
- 大型数据集使用分页加载
- 后台任务使用低优先级队列
- 图片资源优化压缩
- 监控内存使用情况防止泄漏
- 耗电量监控与优化
- 冷启动时间控制在2秒以内

## 📦 版本控制
- 使用Git进行代码管理
- 分支策略：main/develop/feature
- 提交信息格式：`[类型]: 描述`（例如`[feat]: 添加健康数据分析图表`）
- 使用Pull Request进行代码审查
- 版本号遵循语义化版本规范（X.Y.Z）
- 重要修改保留CHANGELOG

## 🚀 发布流程
- 使用CI/CD自动化构建与测试
- 发布前完成用户体验测试
- App Store审核材料标准化
- 灰度发布策略（TestFlight先行测试）
- 监控App Store评论与反馈
- 建立快速响应机制处理紧急问题 